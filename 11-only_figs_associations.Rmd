# Associations QC



```{r, echo=FALSE}
library(png)
library(grid)
```

```{r, echo=FALSE}
working_dir="/home/labs/davidgo/Collaboration/L4_MPRA"
output_dir=sprintf("%s/test_QC",working_dir)
```

## barcode count per oligo

This is a placeholder for an explanation on the analysis, perhaps mention what
is considered to be good or bad example

```{r,echo=FALSE}


bad_example <- readPNG("/home/labs/davidgo/Collaboration/L4_MPRA/test_QC/satmutMPRA_L4a4/barcode count per oligo with zero.png",native = T)
good_example <- readPNG("/home/labs/davidgo/Collaboration/L4_MPRA/test_QC/humanMPRA_L3a2/barcode count per oligo with zero.png",native = T)


# Start new page and define layout
grid.newpage()
pushViewport(viewport(layout = grid.layout(1, 2)))

# Helper to specify location in layout
vplayout <- function(row, col) viewport(layout.pos.row = row, layout.pos.col = col)

# Draw both images in the layout without using print()
pushViewport(vplayout(1, 1))
grid.raster(bad_example, interpolate = FALSE)
popViewport()

pushViewport(vplayout(1, 2))
grid.raster(good_example, interpolate = FALSE)
popViewport()
```


## Oligo Coverage

```{r,echo=FALSE}


bad_example <- readPNG("/home/labs/davidgo/Collaboration/L4_MPRA/test_QC/satmutMPRA_L4a4/Retrieved oligos by barcode threshold.png",native = T)
good_example <- readPNG("/home/labs/davidgo/Collaboration/L4_MPRA/test_QC/humanMPRA_L3a2/Retrieved oligos by barcode threshold.png",native = T)


# Start new page and define layout
grid.newpage()
pushViewport(viewport(layout = grid.layout(1, 2)))

# Helper to specify location in layout
vplayout <- function(row, col) viewport(layout.pos.row = row, layout.pos.col = col)

# Draw both images in the layout without using print()
pushViewport(vplayout(1, 1))
grid.raster(bad_example, interpolate = FALSE)
popViewport()

pushViewport(vplayout(1, 2))
grid.raster(good_example, interpolate = FALSE)
popViewport()
```


## PCR analysis bias - G strech

```{r,echo=FALSE}


bad_example <- readPNG("/home/labs/davidgo/Collaboration/L4_MPRA/test_QC/satmutMPRA_L4a3/barcodes per oligo by G strech.png",native = T)
good_example <- readPNG("/home/labs/davidgo/Collaboration/L4_MPRA/test_QC/humanMPRA_L3a1/barcodes per oligo by G strech.png",native = T)


# Start new page and define layout
grid.newpage()
pushViewport(viewport(layout = grid.layout(1, 2)))

# Helper to specify location in layout
vplayout <- function(row, col) viewport(layout.pos.row = row, layout.pos.col = col)

# Draw both images in the layout without using print()
pushViewport(vplayout(1, 1))
grid.raster(bad_example, interpolate = FALSE)
popViewport()

pushViewport(vplayout(1, 2))
grid.raster(good_example, interpolate = FALSE)
popViewport()
```


## PCR analysis bias - GC content

```{r,echo=FALSE}


bad_example <- readPNG("/home/labs/davidgo/Collaboration/L4_MPRA/test_QC/humanMPRA_L3a1/reads per oligo by gc.png",native = T)
good_example <- readPNG("/home/labs/davidgo/Collaboration/L4_MPRA/test_QC/satmutMPRA_L4a3/reads per oligo by gc.png",native = T)


# Start new page and define layout
grid.newpage()
pushViewport(viewport(layout = grid.layout(1, 2)))

# Helper to specify location in layout
vplayout <- function(row, col) viewport(layout.pos.row = row, layout.pos.col = col)

# Draw both images in the layout without using print()
pushViewport(vplayout(1, 1))
grid.raster(bad_example, interpolate = FALSE)
popViewport()

pushViewport(vplayout(1, 2))
grid.raster(good_example, interpolate = FALSE)
popViewport()
```


```{r, echo=FALSE}

```

```{r, echo=FALSE}

```

```{r, echo=FALSE}

```
